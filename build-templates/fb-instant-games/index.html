<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />

    <title>Water</title>

    <!--http://www.html5rocks.com/en/mobile/mobifying/-->
    <meta
      name="viewport"
      content="width=device-width,user-scalable=no,initial-scale=1, minimum-scale=1,maximum-scale=1"
    />

    <!--https://developer.apple.com/library/safari/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html-->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="format-detection" content="telephone=no" />

    <!-- force webkit on 360 -->
    <meta name="renderer" content="webkit" />
    <meta name="force-rendering" content="webkit" />
    <!-- force edge on IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="msapplication-tap-highlight" content="no" />

    <!-- force full screen on some browser -->
    <meta name="full-screen" content="yes" />
    <meta name="x5-fullscreen" content="true" />
    <meta name="360-fullscreen" content="true" />

    <!-- force screen orientation on some browser -->
    <meta name="screen-orientation" content="portrait" />
    <meta name="x5-orientation" content="portrait" />

    <!--fix fireball/issues/3568 -->
    <!--<meta name="browsermode" content="application">-->
    <meta name="x5-page-mode" content="app" />

    <!--<link rel="apple-touch-icon" href=".png" />-->
    <!--<link rel="apple-touch-icon-precomposed" href=".png" />-->

    <link rel="stylesheet" type="text/css" href="style-mobile.css" />
  </head>

  <body>
    <canvas
      id="GameCanvas"
      oncontextmenu="event.preventDefault()"
      tabindex="0"
    ></canvas>
    <script>
      window.YoungVersion = "1.0.0";
      window.loadPercent = 0;

      window.couldGoToGame = false;
      window.hasGoToGame = false;

      function setLoading(percent) {
        if (window.hasGoToGame) return;

        window.loadPercent += percent;

        if (window.loadPercent >= 96) {
          if (!window.couldGoToGame) window.loadPercent = 96;
        }

        if (window.loadPercent >= 100) {
          window.loadPercent = 100;
          if (window.couldGoToGame && window.realGoGameFromIndex)
            window.realGoGameFromIndex();
        }

        FBInstant.setLoadingProgress(window.loadPercent);

        let _million = window.couldGoToGame ? 30 : 225;
        let _per = window.couldGoToGame ? 4 : 1;

        setTimeout(function () {
          setLoading(_per);
        }, _million);
      }

      function onFBEngineFailedToLoad() {

        loadFBEngine();
      }

      function onFBEngineLoaded() {
        try {
          setLoading(1);
        } catch (e) {}

        FBInstant.initializeAsync()
          .then(function () {
            setLoading(1);
            window.isFBSDKReady = true;

            if (window.enterboot) window.enterboot();
          })
          .catch(function () {
            FBInstant.initializeAsync()
              .then(function () {
                setLoading(1);
                window.isFBSDKReady = true;
                if (window.enterboot) window.enterboot();
              })
              .catch(function () {});
          });
      }

      function loadFBEngine() {
        var element = document.getElementById("fbInstant");
        if (element && element.parentElement == document) {
          document.removeChild(element);
        }
        var fbinstant = document.createElement("script");
        fbinstant.id = "fbInstant";
        fbinstant.src = "https://connect.facebook.net/en_US/fbinstant.7.1.js";
        fbinstant.onload = onFBEngineLoaded;
        fbinstant.onerror = onFBEngineFailedToLoad;
        document.body.appendChild(fbinstant);
      }

      loadFBEngine();
    </script>

    <script src="src/settings.js" charset="utf-8"></script>
    <!-- <script src="vconsole.min.js"></script> -->
    <script src="main.js" charset="utf-8"></script>
  </body>
</html>
